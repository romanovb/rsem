---
title: "Сравнение точности методов прогнозирования"
author: "<ваше имя>"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Введение

В этом задании необходимо сравнить эффективность четырех методов прогнозирования: наивный прогноз, сезонный наивный прогноз, метод усреднения, метод дрейфа на примере показателя: `Реальная зарплата (WAG_M)` (из ЕАЭСД).

Выполните пункты задания, перечисленные ниже и ответьте на поставленные в задании вопросы.

Решения присылайте в HTML-формате на `postlogist@gmail.com`.

Задание можно делать в небольших группах (2-3 человека). Не забудьте указать авторов в заголовке документа.

------


# Задание

1. Загрузите из ЕАЭСД (sophist) показатель **Реальная зарплата (WAG_M)**
Разделите ряд на тестовый (последние 12 месяцев от имеющихся данных) и обучающий (данные с января 2010 года до начала тестового периода). 

2. Используя данные обучающего периода, постройте 4 простых модели прогнозирования (среднее, наивный и сезонный наивный прогноз, прогноз методом дрейфа). Разработайте прогноз на тестовый период.

3. Сравните и интерпретируйте показатели ошибки использованных методов прогнозирования:

 - на обучающем и тестовом периодах;
 - методом скользящего контроля (для этого метода можно использовать все данные).
 
4. Напишите вывод о том, какой метод оказался наиболее точным и почему?




```{r Подключение библиотек, warning=FALSE, message=FALSE}
library(tidyverse) # визуализация и трансформация данных
library(forecast) # анализ временных рядов и прогнозирование
library(fpp) # Примеры временных рядов
library(sophisthse) # Загрузка временных рядов из базы Sophist
```

```{r}
wag <- sophisthse('WAG_M')
# sophisthse_metadata(wag)

wag <- wag[,1]
```



```{r}
autoplot(wag)

wagt <- wag %>% window(start = c(2016, 11), end = c(2017, 10) )
wagl <- wag %>% window(start = 1993, end = c(2016, 10))

```

```{r}
wag_m <- meanf(wagl, h = 12)
wag_n <- naive (wagl, h = 12)
wag_sn <- snaive (wagl, h = 12)
wag_d <- rwf(wagl, h = 12)


autoplot(wagl, series = "Обучающий период") +
  autolayer(wag_m, PI = F, series = "Среднее") +
  autolayer(wag_n, PI = F, series = "Наивный") +
  autolayer(wag_sn, PI = F, series = "Сезонный наивный") +
  autolayer(wag_d, PI = F, series = "Дрифт") 

autoplot(window(wagl, start = 2014), series = "Обучающий период") +
  autolayer(wag_m, PI = F, series = "Среднее") +
  autolayer(wag_n, PI = F, series = "Наивный") +
  autolayer(wag_sn, PI = F, series = "Сезонный наивный") +
  autolayer(wag_d, PI = F, series = "Дрифт") 
```

```{r}
rbind(accuracy(wag_m, wag)[2,], # ошибки в тестовом периоде - 2 строка
      accuracy(wag_n, wag)[2,],
      accuracy(wag_sn, wag)[2,],
      accuracy(wag_d, wag)[2,]) %>%
  
  as_tibble() %>%
  round(2) %>%
  mutate(`Метод` = c('Среднее', 'Наивный', 'С. наивный', 'Дрейф')) %>%
  select(`Метод`, MASE, MAPE, everything()) %>%
  arrange(MASE)

```

